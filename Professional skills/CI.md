CIï¼ˆæŒç»­é›†æˆï¼ŒContinuous Integrationï¼‰æ˜¯ä¸€ç§è½¯ä»¶å¼€å‘å®è·µï¼Œæ—¨åœ¨è®©å¼€å‘å›¢é˜Ÿèƒ½å¤Ÿæ›´å¿«åœ°å‘ç°å’Œä¿®å¤é—®é¢˜ï¼Œä»è€Œæé«˜è½¯ä»¶è´¨é‡å’Œå¼€å‘æ•ˆç‡ã€‚ä»¥ä¸‹æ˜¯ CI çš„è¯¦ç»†ä»‹ç»å’Œå®ƒåœ¨é¡¹ç›®ä¸­çš„ä½œç”¨ï¼š

### 1. **CI çš„æ¦‚å¿µ**

- **æŒç»­é›†æˆ**æ˜¯ä¸€ç§å¼€å‘å®è·µï¼ŒæŒ‡çš„æ˜¯å›¢é˜Ÿæˆå‘˜å°†ä»–ä»¬çš„ä»£ç é¢‘ç¹åœ°ï¼ˆé€šå¸¸æ˜¯æ¯å¤©å¤šæ¬¡ï¼‰é›†æˆåˆ°å…±äº«çš„ä»£ç åº“ä¸­ã€‚æ¯æ¬¡ä»£ç é›†æˆåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ„å»ºé¡¹ç›®ï¼Œå¹¶è¿è¡Œä¸€ç³»åˆ—è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä»¥ç¡®ä¿æ–°ä»£ç ä¸ä¼šç ´åç°æœ‰åŠŸèƒ½ã€‚
- CI çš„ç›®æ ‡æ˜¯å°½æ—©å‘ç°ä»£ç é”™è¯¯ï¼Œè®©é—®é¢˜åœ¨å¼€å‘é˜¶æ®µå°±èƒ½è¢«ä¿®å¤ï¼Œè€Œä¸æ˜¯åœ¨éƒ¨ç½²æˆ–ç”Ÿäº§ç¯å¢ƒä¸­æš´éœ²ã€‚

### 2. **CI çš„å·¥ä½œæµç¨‹**

ä¸€ä¸ªå…¸å‹çš„ CI æµç¨‹åŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼š

- **ä»£ç æäº¤**ï¼šå¼€å‘è€…å°†ä»£ç æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆå¦‚ Gitï¼‰ä¸­çš„é¡¹ç›®ä»“åº“ã€‚
- **è‡ªåŠ¨è§¦å‘æ„å»º**ï¼šCI ç³»ç»Ÿï¼ˆå¦‚ GitHub Actionsã€Jenkinsã€GitLab CI/CD ç­‰ï¼‰æ£€æµ‹åˆ°ä»£ç æäº¤åï¼Œä¼šè‡ªåŠ¨è§¦å‘æ„å»ºè¿‡ç¨‹ã€‚
- **è¿è¡Œæµ‹è¯•**ï¼šæ„å»ºå®Œæˆåï¼ŒCI ç³»ç»Ÿä¼šè‡ªåŠ¨è¿è¡Œé¢„è®¾çš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œæ£€æŸ¥æ–°æäº¤çš„ä»£ç æ˜¯å¦å¼•å…¥äº†é”™è¯¯ã€‚
- **ç”Ÿæˆåé¦ˆ**ï¼šCI ç³»ç»Ÿå°†æµ‹è¯•ç»“æœç”ŸæˆæŠ¥å‘Šï¼Œåé¦ˆç»™å¼€å‘è€…ã€‚å¦‚æœæµ‹è¯•é€šè¿‡ï¼Œä»£ç å¯ä»¥åˆå¹¶åˆ°ä¸»åˆ†æ”¯ï¼›å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œå¼€å‘è€…éœ€è¦ä¿®å¤é—®é¢˜å¹¶é‡æ–°æäº¤ä»£ç ã€‚

### 3. **CI çš„é‡è¦æ€§**

- **æé«˜ä»£ç è´¨é‡**ï¼šé€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œå¯ä»¥åŠæ—¶å‘ç°é—®é¢˜ï¼Œç¡®ä¿ä»£ç è´¨é‡ã€‚
- **å‡å°‘é›†æˆéš¾åº¦**ï¼šé¢‘ç¹é›†æˆä½¿å¾—æ¯æ¬¡æäº¤çš„ä»£ç é‡å˜å°‘ï¼Œé™ä½äº†é›†æˆçš„å¤æ‚æ€§ã€‚
- **åŠ å¿«å¼€å‘é€Ÿåº¦**ï¼šCI èƒ½è®©å¼€å‘äººå‘˜å¿«é€Ÿå¾—åˆ°åé¦ˆï¼Œä¸éœ€è¦ç­‰å¾…äººå·¥æµ‹è¯•ï¼Œæå¤§æé«˜äº†å¼€å‘æ•ˆç‡ã€‚
- **å¢å¼ºåä½œ**ï¼šCI èƒ½å¤Ÿè®©å›¢é˜Ÿæˆå‘˜åœ¨åŒä¸€ä¸ªä»“åº“ä¸­é«˜æ•ˆåä½œï¼Œç¡®ä¿ä»£ç åº“å§‹ç»ˆå¤„äºå¯ç”¨çš„çŠ¶æ€ã€‚

### 4. **CI åœ¨è¿™ä¸ªé¡¹ç›®ä¸­çš„åº”ç”¨**

åœ¨æ­¤é¡¹ç›®ä¸­ï¼ŒCI ä¸»è¦ç”¨äºç¡®ä¿ï¼š

- **ä»£ç çš„æ„å»ºå’Œè¿è¡Œç¨³å®šæ€§**ï¼šæ¯æ¬¡ä»£ç æ›´æ”¹éƒ½ä¼šè‡ªåŠ¨æ„å»ºï¼ŒéªŒè¯ä»£ç æ˜¯å¦å¯ä»¥æˆåŠŸè¿è¡Œã€‚
- **è‡ªåŠ¨åŒ–æµ‹è¯•**ï¼šæ¯æ¬¡æäº¤åï¼ŒCI ç³»ç»Ÿä¼šè¿è¡Œä½ å®ç°çš„å•å…ƒæµ‹è¯•ï¼Œç¡®ä¿æ–°ä»£ç æ²¡æœ‰ç ´åç°æœ‰åŠŸèƒ½ã€‚
- **å›¢é˜Ÿåä½œçš„å¯é æ€§**ï¼šç”±äºæ˜¯å¤šäººåä½œçš„é¡¹ç›®ï¼ŒCI èƒ½ç¡®ä¿æ¯ä¸ªæˆå‘˜æäº¤çš„ä»£ç ä¸ä¼šå¼•å…¥æ–°çš„é”™è¯¯ï¼Œä»è€Œä¿è¯é¡¹ç›®çš„æ•´ä½“è´¨é‡ã€‚

### 5. **å¦‚ä½•è®¾ç½® CI**

åœ¨ GitHub ä¸Šï¼Œä½ å¯ä»¥ä½¿ç”¨ **GitHub Actions** è®¾ç½® CIã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ YAML é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼Œé€šå¸¸å‘½åä¸º `.github/workflows/ci.yml`ï¼Œæ”¾ç½®åœ¨é¡¹ç›®çš„ GitHub ä»“åº“ä¸­ï¼š

```yaml
name: C++ CI

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up C++ build environment
      run: sudo apt-get install -y g++ cmake

    - name: Configure CMake
      run: cmake -S . -B build

    - name: Build project
      run: cmake --build build

    - name: Run tests
      run: ./build/tests  # å‡è®¾ä½ æœ‰ä¸€ä¸ªå« tests çš„æµ‹è¯•å¯æ‰§è¡Œæ–‡ä»¶
```

è¿™ä¸ªç¤ºä¾‹é…ç½®çš„ CI æµç¨‹åŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼š

- æ£€æµ‹ä»£ç å˜åŠ¨ï¼ˆå½“æ¨é€åˆ° `main` åˆ†æ”¯æˆ–æäº¤ Pull Request æ—¶è§¦å‘ï¼‰ã€‚
- è®¾ç½® C++ ç¯å¢ƒå¹¶æ„å»ºé¡¹ç›®ã€‚
- æ„å»ºåè‡ªåŠ¨è¿è¡Œæµ‹è¯•ï¼Œæ£€æŸ¥ä»£ç çš„æ­£ç¡®æ€§ã€‚

### 6. **æ€»ç»“**

CI æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–è¿‡ç¨‹ï¼Œå¸®åŠ©å¼€å‘å›¢é˜Ÿåœ¨ä»£ç åº“ä¸­é¢‘ç¹é›†æˆå¹¶è‡ªåŠ¨æµ‹è¯•æ¯æ¬¡æäº¤çš„ä»£ç ã€‚å®ƒèƒ½å¤Ÿæé«˜ä»£ç è´¨é‡ã€ç¼©çŸ­å¼€å‘å‘¨æœŸï¼Œå°¤å…¶é€‚åˆå¤šäººåä½œçš„é¡¹ç›®ã€‚





# Our Project

```yml
name: Group 404 C++ CI with CMake and Googletest

on:
  push:
    branches:
      - feature-googletest
  pull_request:
    branches:
      - feature-googletest

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Install dependencies (apt / cmake / gcc)
      run: sudo apt-get update && sudo apt-get install -y cmake g++

    - name: Configure CMake
      run: cmake -S . -B build

    - name: Build project
      run: cmake --build build

    - name: Run tests
      run: |
        cd build
        ctest --output-on-failure

```

è¿™ä¸ª GitHub Actions é…ç½®æ–‡ä»¶ç”¨äºè‡ªåŠ¨åŒ– C++ é¡¹ç›®çš„æ„å»ºå’Œæµ‹è¯•æµç¨‹ã€‚å·¥ä½œæµçš„åç§°ä¸ºâ€œGroup 404 C++ CI with CMake and Googletestâ€ï¼Œä¼šåœ¨æ¨é€åˆ° `feature-googletest` åˆ†æ”¯æˆ–æäº¤åˆ°è¯¥åˆ†æ”¯çš„ Pull Request æ—¶è‡ªåŠ¨è§¦å‘ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£é‡Šï¼š

### æ–‡ä»¶ç»“æ„ä¸è§¦å‘æ¡ä»¶

```
yaml


å¤åˆ¶ä»£ç 
name: Group 404 C++ CI with CMake and Googletest
```

- **name**ï¼šä¸ºè¿™ä¸ª GitHub Actions å·¥ä½œæµå‘½åã€‚åœ¨ GitHub Actions ç•Œé¢ä¸­å¯ä»¥çœ‹åˆ°è¿™ä¸ªåç§°ï¼Œä¾¿äºåŒºåˆ†ä¸åŒçš„å·¥ä½œæµã€‚

```
yaml


å¤åˆ¶ä»£ç 
on:
  push:
    branches:
      - feature-googletest
  pull_request:
    branches:
      - feature-googletest
```

- on

  ï¼šå®šä¹‰å·¥ä½œæµçš„è§¦å‘æ¡ä»¶ã€‚

  - **push**ï¼šå½“ä»£ç è¢«æ¨é€åˆ° `feature-googletest` åˆ†æ”¯æ—¶è§¦å‘å·¥ä½œæµã€‚
  - **pull_request**ï¼šå½“æœ‰äººå¯¹ `feature-googletest` åˆ†æ”¯å‘èµ· Pull Request æ—¶è§¦å‘å·¥ä½œæµã€‚

### å·¥ä½œæµçš„å…·ä½“ä»»åŠ¡

å·¥ä½œæµä¸­çš„ä»»åŠ¡è¢«å®šä¹‰ä¸ºä¸€ä¸ª `jobs` èŠ‚ç‚¹ï¼ŒåŒ…å« `build` ä»»åŠ¡ã€‚

```
yaml


å¤åˆ¶ä»£ç 
jobs:
  build:
    runs-on: ubuntu-latest
```

- **jobs**ï¼šå®šä¹‰äº† CI æµç¨‹ä¸­çš„å…·ä½“ä»»åŠ¡ã€‚
- **build**ï¼šè¿™æ˜¯ä»»åŠ¡çš„åç§°ï¼Œè´Ÿè´£æ„å»ºå’Œæµ‹è¯•é¡¹ç›®ã€‚
- **runs-on**ï¼šæŒ‡å®šä»»åŠ¡åœ¨ `ubuntu-latest` è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œï¼ˆå³ Ubuntu æ“ä½œç³»ç»Ÿï¼‰ã€‚

### ä»»åŠ¡æ­¥éª¤ï¼ˆstepsï¼‰

å„æ­¥éª¤æŒ‰é¡ºåºæ‰§è¡Œï¼Œå®Œæˆä»£ç æ£€å‡ºã€ä¾èµ–å®‰è£…ã€é¡¹ç›®é…ç½®ã€ç¼–è¯‘å’Œæµ‹è¯•ï¼š

```
yaml


å¤åˆ¶ä»£ç 
steps:
    - name: Checkout repository
      uses: actions/checkout@v2
```

- **Checkout repository**ï¼šä½¿ç”¨ `actions/checkout@v2` ä» GitHub æ£€å‡ºé¡¹ç›®çš„ä»£ç åº“åˆ°å·¥ä½œæµç¯å¢ƒä¸­ï¼Œä»¥ä¾¿åç»­æ­¥éª¤å¯ä»¥è®¿é—®ä»£ç æ–‡ä»¶ã€‚

```
yaml


å¤åˆ¶ä»£ç 
    - name: Install dependencies (apt / cmake / gcc)
      run: sudo apt-get update && sudo apt-get install -y cmake g++
```

- **Install dependencies**ï¼šå®‰è£…æ‰€éœ€çš„ä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬ `cmake` å’Œ `g++`ã€‚è¿™ä¸€æ­¥ä½¿ç”¨ Ubuntu çš„åŒ…ç®¡ç†å™¨ `apt` æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨ï¼Œå¹¶å®‰è£… CMake å’Œ G++ï¼ˆç”¨äºæ„å»º C++ é¡¹ç›®ï¼‰ã€‚

```
yaml


å¤åˆ¶ä»£ç 
    - name: Configure CMake
      run: cmake -S . -B build
```

- Configure CMake

  ï¼šåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ CMake è¿›è¡Œé…ç½®ã€‚

  - `-S .`ï¼šæŒ‡å®šå½“å‰ç›®å½•ï¼ˆé¡¹ç›®çš„æ ¹ç›®å½•ï¼‰ä¸ºæºä»£ç ç›®å½•ã€‚
  - `-B build`ï¼šæŒ‡å®š CMake åœ¨ `build` ç›®å½•ä¸­ç”Ÿæˆæ„å»ºæ–‡ä»¶ï¼ˆå¦‚ Makefileï¼‰ã€‚è¿™ä¸€è¿‡ç¨‹ä¼šè¯»å– `CMakeLists.txt`ï¼Œæ ¹æ®é…ç½®ç”Ÿæˆé€‚åˆè¯¥ç¯å¢ƒçš„æ„å»ºæ–‡ä»¶ã€‚

```
yaml


å¤åˆ¶ä»£ç 
    - name: Build project
      run: cmake --build build
```

- **Build project**ï¼šä½¿ç”¨ CMake æ„å»ºé¡¹ç›®ã€‚`cmake --build build` ä¼šåœ¨ `build` ç›®å½•ä¸­ç¼–è¯‘ä»£ç å¹¶ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶å’Œæµ‹è¯•æ–‡ä»¶ã€‚

```
yaml


å¤åˆ¶ä»£ç 
    - name: Run tests
      run: |
        cd build
        ctest --output-on-failure
```

- Run tests

  ï¼šè¿›å…¥ 

  ```
  build
  ```

   ç›®å½•å¹¶è¿è¡Œæµ‹è¯•ã€‚

  - `cd build`ï¼šåˆ‡æ¢åˆ° `build` ç›®å½•ï¼Œè¿™æ˜¯æ„å»ºæ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚
  - `ctest --output-on-failure`ï¼šè¿è¡Œ CTest å‘½ä»¤ï¼Œè¯¥å‘½ä»¤ä¼šè‡ªåŠ¨æ‰§è¡Œ `add_test` ä¸­å®šä¹‰çš„æµ‹è¯•ã€‚`--output-on-failure` å‚æ•°ä½¿å¾—åœ¨æµ‹è¯•å¤±è´¥æ—¶è¾“å‡ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼Œä¾¿äºè°ƒè¯•ã€‚

### æ€»ç»“

è¿™ä¸ªå·¥ä½œæµä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. åœ¨ `feature-googletest` åˆ†æ”¯æ¨é€æˆ–åˆ›å»º PR æ—¶è§¦å‘ã€‚
2. ä½¿ç”¨ Ubuntu ä½œä¸ºè™šæ‹Ÿç¯å¢ƒï¼Œæ£€å‡ºä»£ç å¹¶å®‰è£…ä¾èµ–ã€‚
3. ä½¿ç”¨ CMake é…ç½®é¡¹ç›®ï¼Œå¹¶åœ¨ `build` ç›®å½•ä¸­æ„å»ºé¡¹ç›®ã€‚
4. è¿è¡Œæµ‹è¯•å¹¶è¾“å‡ºç»“æœã€‚å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œå°†è¾“å‡ºè¯¦ç»†çš„å¤±è´¥ä¿¡æ¯ã€‚

è¿™ä¸ª CI é…ç½®ç¡®ä¿æ¯æ¬¡ä»£ç æ¨é€æˆ– PR åˆ›å»ºæ—¶ï¼Œéƒ½è‡ªåŠ¨è¿›è¡Œæ„å»ºå’Œæµ‹è¯•ï¼Œå¸®åŠ©å¼€å‘è€…åŠæ—¶å‘ç°ä»£ç é—®é¢˜ã€‚





# é“¾æ¥ğŸ”—



[èœé¸Ÿæ•™ç¨‹](https://www.runoob.com/w3cnote/yaml-intro.html)

https://github.com/readme/guides/sothebys-github-actions

https://github.blog/enterprise-software/ci-cd/build-ci-cd-pipeline-github-actions-four-steps/